<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

   <head>
      <th:block th:replace="fragment/fragment :: scr-head"> </th:block>      
      <link rel="stylesheet" href="/estateListCss.css">
      <title>Lista Immobili</title>
   </head>
   <body>
      <thead>
         <th:block th:replace="fragment/fragment :: navbar"></th:block>
      </thead>
       
      <h2 class="text-center fw-bold mt-3">Ricerca l'immobile per campi</h2>
      <div class="container d-flex justify-content-center p-3">
         <form action="/estate/search">
            <div class="row d-flex my-3 ">
               <div class="row d-flex ">
                  <div class="col-3">
                     <input class="form-control" type="text" name="queryAddress" placeholder="Indirizzo">
                  </div>
                  <div class="col-2">
                     <input class="form-control col-2" type="text" name="queryZipCode" placeholder="CAP">
                  </div>
                  <div class="col-2">
                     <input class="form-control col-2" type="text" name="queryCity" placeholder="Citt&aacute;">
                  </div>
                  <div class="col-2 me-1 ms-2">
                     <select
                        name="queryProvince"
                        >
                        <option value="">--Provincia--</option>
                        <option value="AG">Agrigento</option>
                        <option value="AL">Alessandria</option>
                        <option value="AN">Ancona</option>
                        <option value="AO">Aosta</option>
                        <option value="AR">Arezzo</option>
                        <option value="AP">Ascoli-Piceno</option>
                        <option value="AT">Asti</option>
                        <option value="AV">Avellino</option>
                        <option value="BA">Bari</option>
                        <option value="BT">Barletta-Andria-Trani</option>
                        <option value="BL">Belluno</option>
                        <option value="BN">Benevento</option>
                        <option value="BG">Bergamo</option>
                        <option value="BI">Biella</option>
                        <option value="BO">Bologna</option>
                        <option value="BZ">Bolzano</option>
                        <option value="BS">Brescia</option>
                        <option value="BR">Brindisi</option>
                        <option value="CA">Cagliari</option>
                        <option value="CL">Caltanissetta</option>
                        <option value="CB">Campobasso</option>
                        <option value="CI">Carbonia-Iglesias</option>
                        <option value="CE">Caserta</option>
                        <option value="CT">Catania</option>
                        <option value="CZ">Catanzaro</option>
                        <option value="CH">Chieti</option>
                        <option value="CO">Como</option>
                        <option value="CS">Cosenza</option>
                        <option value="CR">Cremona</option>
                        <option value="KR">Crotone</option>
                        <option value="CN">Cuneo</option>
                        <option value="EN">Enna</option>
                        <option value="FM">Fermo</option>
                        <option value="FE">Ferrara</option>
                        <option value="FI">Firenze</option>
                        <option value="FG">Foggia</option>
                        <option value="FC">Forl√¨-Cesena</option>
                        <option value="FR">Frosinone</option>
                        <option value="GE">Genova</option>
                        <option value="GO">Gorizia</option>
                        <option value="GR">Grosseto</option>
                        <option value="IM">Imperia</option>
                        <option value="IS">Isernia</option>
                        <option value="SP">La Spezia</option>
                        <option value="AQ">L'Aquila</option>
                        <option value="LT">Latina</option>
                        <option value="LE">Lecce</option>
                        <option value="LC">Lecco</option>
                        <option value="LI">Livorno</option>
                        <option value="LO">Lodi</option>
                        <option value="LU">Lucca</option>
                        <option value="MC">Macerata</option>
                        <option value="MN">Mantova</option>
                        <option value="MS">Massa-Carrara</option>
                        <option value="MT">Matera</option>
                        <option value="VS">Medio Campidano</option>
                        <option value="ME">Messina</option>
                        <option value="MI">Milano</option>
                        <option value="MO">Modena</option>
                        <option value="MB">Monza e Brianza</option>
                        <option value="NA">Napoli</option>
                        <option value="NO">Novara</option>
                        <option value="NU">Nuoro</option>
                        <option value="OG">Ogliastra</option>
                        <option value="OT">Olbia-Tempio</option>
                        <option value="OR">Oristano</option>
                        <option value="PD">Padova</option>
                        <option value="PA">Palermo</option>
                        <option value="PR">Parma</option>
                        <option value="PV">Pavia</option>
                        <option value="PG">Perugia</option>
                        <option value="PU">Pesaro e urbino</option>
                        <option value="PE">Pescara</option>
                        <option value="PC">Piacenza</option>
                        <option value="PI">Pisa</option>
                        <option value="PT">Pistoia</option>
                        <option value="PN">Pordenone</option>
                        <option value="PZ">Potenza</option>
                        <option value="PO">Prato</option>
                        <option value="RG">Ragusa</option>
                        <option value="RA">Ravenna</option>
                        <option value="RC">Reggio Calabria</option>
                        <option value="RE">Reggio Emilia</option>
                        <option value="RI">Rieti</option>
                        <option value="RN">Rimini</option>
                        <option value="RM">Roma</option>
                        <option value="RO">Rovigo</option>
                        <option value="SA">Salerno</option>
                        <option value="SS">Sassari</option>
                        <option value="SV">Savona</option>
                        <option value="SI">Siena</option>
                        <option value="SR">Siracusa</option>
                        <option value="SO">Sondrio</option>
                        <option value="TA">Taranto</option>
                        <option value="TE">Teramo</option>
                        <option value="TR">Terni</option>
                        <option value="TO">Torino</option>
                        <option value="TP">Trapani</option>
                        <option value="TN">Trento</option>
                        <option value="TV">Treviso</option>
                        <option value="TS">Trieste</option>
                        <option value="UD">Udine</option>
                        <option value="VA">Varese</option>
                        <option value="VE">Venezia</option>
                        <option value="VB">Verbano-Cusio-Ossola</option>
                        <option value="VC">Vercelli</option>
                        <option value="VR">Verona</option>
                        <option value="VV">Vibo Valentia</option>
                        <option value="VI">Vicenza</option>
                        <option value="VT">Viterbo</option>
                     </select>
                  </div>                  
                  <div class="d-flex col-2 ms-5">
	                  Vendita: <input class="form-check-input" type="radio" name="queryStatus" value="In vendita">
	                  Affitto: <input class="form-check-input" type="radio" name="queryStatus" value="In affitto">
	               </div>                  
               </div>
            </div>
          <div class="d-flex justify-content-end" > <button href="#" type="button" class=" btn btn-info" id="attivaFiltri">Filtri Avanzati</button> </div>

            <div id="filtriAvanzati" style="display: none;">
	            <div class="row d-flex my-4">
	               <div class="col-2">
	                  <input class="form-control" type="number" name="queryAreaHigher" placeholder="Superficie maggiore di">
	               </div>
	               <div class="col-2">
	                  <input class="form-control" type="number" name="queryAreaLower" placeholder="Superficie minore di">
	               </div>
	               <div class="col-3">
	                  <input class="form-control" type="number" name="queryPriceHigher" placeholder="Prezzo maggiore di">
	               </div>
	               <div class="col-3">
	                  <input class="form-control" type="number" name="queryPriceLower" placeholder="Prezzo minore di">
	               </div>
	               <div class="col-2">
                     <select
                        name="energyClass"
                        >
                        <option value="">--Classe Energetica--</option>
                        <option value="A4">A4</option>
                        <option value="A3">A3</option>
                        <option value="A2">A2</option>
                        <option value="A1">A1</option>
                        <option value="B">B</option>
                        <option value="C">C</option>
                        <option value="D">D</option>
                        <option value="E">E</option>
                        <option value="F">F</option>
                        <option value="G">G</option>
                     </select>
                  </div>
	               
	            </div>
	            <div class="row d-flex my-5">
	            	<div class="col-3">
	                  <input class="form-control" type="text" name="queryType" placeholder="Tipologia immobile">
	               </div>
	               <div class="col-2">
	                  <input class="form-control" type="number" name="queryNumSpaces" placeholder="Numero di vani">
	               </div>
	               <div class="col-2">
	                  <input class="form-control" type="number" name="queryNumBathrooms" placeholder="Numero di bagni">
	               </div>
	               <div class="col-2">
	                  <input class="form-control" type="number" name="queryNumBalconies" placeholder="Numero di Balconi">
	               </div>
	               <div class="col-3">
	                  Posto auto : <input class="form-check-input" type="checkbox" name="queryHasCarSpot">
	                  Giardino : <input class="form-check-input" type="checkbox" name="queryHasGarden">
	               </div>
	            </div>
	           </div>
            <div class=" d-flex justify-content-end ">
               <button type="submit" class="btn btn-danger my-2">Cerca</button> 
            </div>
          </div>
        </div>
      </form>
    </div>
    <hr />
    <div th:if="${#lists.isEmpty(estateList)}" class="text-center">
      <h1>Mi dispiace non ci sono ancora immobili nel catalogo.</h1>
       <a href="/estate" class="mb-2 mt-2 btn btn-info">
                      Torna alla lista completa
                   </a>
    </div>
    <div class="container mb-2">
      <div th:unless="${#lists.isEmpty(estateList)}">
        <h2 class="text-center mt-3 mb-4">Ecco La Lista degli Immobili</h2>
        <div class="row" th:each="e : ${estateList}">
          <div class="col-3">
            <div
              id="carouselExampleControls"
              class="carousel slide carousel-fade "
              data-bs-ride="carousel"
            >
              <div class="carousel-inner ">
                <div
                  th:if="${e.images.size()==0}"
                  class="carousel-item mb-2 active"
                >
                  <img
                    class="img-fluid border border-dark rounded-5"
                    src="/img/Casa Stilizzata.jpg"
                    alt="template casa"
                  />
                </div>
                <div
                  th:if="${e.images.size()!=0}"
                  class="carousel-item mb-2 border border-dark rounded-3"
                  th:each="img,iter : ${e.images}"
                  th:classappend="${iter.index == 0 ? 'active' : ''}"
                >
                  <img
                    th:src="@{|/estate/image/${img.getId()}/content|}"
                    class="w-100"
                    alt="Immagine immobile"
                  />
                </div>
              </div>
            </div>
          </div>
          <div class="col-8">
	          <div class="row d-flex">
	            	<h2 class="titolo fw-bold col-9" th:text="${e.adTitle}"></h2>
	          		<div class="col-2">
	            		<p 
	            			th:if="${e.getStatusValue(e.getStatus())==2 || e.getStatusValue(e.getStatus())==1}" 
	            			class="badge rounded-pill fs-5" 
	            			th:text="${e.getStatusValue(e.getStatus())==2 ? 'Venduto': 'Affittato'}"
	            			th:classappend="${e.getStatusValue(e.getStatus())==2 ? 'bg-success' : 'bg-warning'}"
	            		>
	            		</p>
	          		</div>
	          </div> 
            <div class="row">
              <div class="col-2 border-start">
                <i class="fa-solid fa-bath"></i>
                <span th:text="${e.numBathrooms}"></span>
              </div>
              <div class="col-2 border-start">
                <i class="fa-solid fa-chart-area"></i>
                <span th:text="|${e.area} mt|"></span>
              </div>
              <div class="col-2 border-start">
                <i class="fa-solid fa-door-open"></i>
                <span th:text="${e.numSpaces}"></span>
              </div>
              <div class="col-6 border-start">
                <h5>
                  <span th:text="${e.getFormattedPrice(e.price)}"></span>
                </h5>
              </div>
            </div>

            <div class="row border-top mt-1">
              <div class="col-10 my-2">
                <h4
                  th:text="|${e.type} Sito in: ${e.address} ${e.zipCode} ${e.city}|"
                ></h4>
              </div>
            </div>
            <div class="row d-flex">
               <div class="col-8 border-top">
                  <h5 class="mt-2">Descrizione</h5>
                  <p
                    class="descrizione"
                    th:text="${e.getSubstringedDescription()}"
                  ></p>
               </div>
                <div class="col-1">
                   <a th:href="@{|/estate/${e.id}|}" class="mb-2 mt-2 btn btn-info">
                      Dettagli
                   </a>
                </div>
            
            
          </div>
          <hr />
        </div>
      </div>
      </div>
    </div>
      <footer>
         <th:block th:replace="fragment/fragment :: footer"></th:block>
      </footer>
      <script type="text/javascript" src="/estateList.js"></script>
   </body>
</html>

