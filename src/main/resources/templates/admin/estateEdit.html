<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
  <head>
    <th:block th:replace="fragment/fragment :: scr-head"></th:block>
    <title>Aggiunta immobile</title>
  </head>
  <body>
    <th:block th:replace="fragment/fragment :: navbar"></th:block>
    <div class="container m-4">
      <h1
        class="text-center"
        th:text="${id != null} ? 'Modifica immobile' : 'Inserisci nuovo immobile'"
      ></h1>
      <form
        id="form-estate"
        th:object="${estate}"
        th:action="@{/estate/admin/estateList/edit}"
        method="POST"
      >
        <input type="hidden" th:field="*{id}" />

        <div class="form-floating mb-3 mt-3 has-validation">
          <input
            type="text"
            class="form-control"
            th:field="*{adTitle}"
            id="adTitle"
            th:errorClass="is-invalid"
            placeholder="Titolo annuncio"
          />
          <label for="floatingInput">Titolo annuncio</label>
          <div th:if="${#fields.hasErrors('adTitle')}" class="invalid-feedback">
            <ul>
              <li
                th:each="err : ${#fields.errors('adTitle')}"
                th:text="${err}"
              ></li>
            </ul>
          </div>
        </div>

        <div class="form-floating mb-3 mt-3 has-validation">
          <textarea
            class="form-control"
            th:field="*{description}"
            id="description"
            th:errorClass="is-invalid"
            placeholder="Descrizione immobile"
            rows="5"
          >
          <label for="floatingInput">Descrizione immobile</label>
          <div th:if="${#fields.hasErrors('description')}" class="invalid-feedback">
            <ul>
              <li
                th:each="err : ${#fields.errors('description')}"
                th:text="${err}"
              ></li>
            </ul>
          </div>
        </div>

        <div class="form-floating mb-3 mt-3 has-validation">
          <input
            type="text"
            class="form-control"
            th:field="*{address}"
            id="address"
            th:errorClass="is-invalid"
            placeholder="Indirizzo"
          />
          <label for="floatingInput">Indirizzo immobile</label>
          <div th:if="${#fields.hasErrors('address')}" class="invalid-feedback">
            <ul>
              <li
                th:each="err : ${#fields.errors('address')}"
                th:text="${err}"
              ></li>
            </ul>
          </div>
        </div>

        <div class="form-floating mb-3 mt-3 has-validation">
          <input
            type="number"
            min="1"
            class="form-control"
            th:field="*{houseNumber}"
            id="houseNumber"
            th:errorClass="is-invalid"
            placeholder="Numero civico"
          />
          <label for="floatingInput">Numero civico</label>
          <div
            th:if="${#fields.hasErrors('houseNumber')}"
            class="invalid-feedback"
          >
            <ul>
              <li
                th:each="err : ${#fields.errors('houseNumber')}"
                th:text="${err}"
              ></li>
            </ul>
          </div>
        </div>

        <div class="form-floating mb-3 mt-3 has-validation">
          <input
            type="number"
            class="form-control"
            th:field="*{floorNumber}"
            id="floorNumber"
            th:errorClass="is-invalid"
            placeholder="Piano"
          />
          <label for="floatingInput">Piano</label>
          <div
            th:if="${#fields.hasErrors('floorNumber')}"
            class="invalid-feedback"
          >
            <ul>
              <li
                th:each="err : ${#fields.errors('floorNumber')}"
                th:text="${err}"
              ></li>
            </ul>
          </div>
        </div>

        <div class="form-floating mb-3 mt-3 has-validation">
          <input
            type="number"
            min="1"
            class="form-control"
            th:field="*{interior}"
            id="interior"
            th:errorClass="is-invalid"
            placeholder="Interno"
          />
          <label for="floatingInput">Interno</label>
          <div
            th:if="${#fields.hasErrors('interior')}"
            class="invalid-feedback"
          >
            <ul>
              <li
                th:each="err : ${#fields.errors('interior')}"
                th:text="${err}"
              ></li>
            </ul>
          </div>
        </div>

        <div class="form-floating mb-3 mt-3 has-validation">
          <input
            type="text"
            class="form-control"
            th:field="*{zipCode}"
            id="zipCode"
            th:errorClass="is-invalid"
            placeholder="CAP"
          />
          <label for="floatingInput">CAP</label>
          <div th:if="${#fields.hasErrors('zipCode')}" class="invalid-feedback">
            <ul>
              <li
                th:each="err : ${#fields.errors('zipCode')}"
                th:text="${err}"
              ></li>
            </ul>
          </div>
        </div>

        <div class="form-floating mb-3 mt-3 has-validation">
          <input
            type="text"
            class="form-control"
            th:field="*{city}"
            id="city"
            th:errorClass="is-invalid"
            placeholder="Città"
          />
          <label for="floatingInput">Città</label>
          <div th:if="${#fields.hasErrors('city')}" class="invalid-feedback">
            <ul>
              <li
                th:each="err : ${#fields.errors('city')}"
                th:text="${err}"
              ></li>
            </ul>
          </div>
        </div>

        <div class="form-floating mb-3 mt-3 has-validation">
          <span> <label for="province">Classe energetica</label> </span>

          <select
            name="province"
            id="province"
            th:field="*{province}"
            th:errorClass="is-invalid"
          >
            <option value="">--Scegli un'opzione--</option>
            <option value="AG">Agrigento</option>
            <option value="AL">Alessandria</option>
            <option value="AN">Ancona</option>
            <option value="AO">Aosta</option>
            <option value="AR">Arezzo</option>
            <option value="AP">Ascoli-Piceno</option>
            <option value="AT">Asti</option>
            <option value="AV">Avellino</option>
            <option value="BA">Bari</option>
            <option value="BT">Barletta-Andria-Trani</option>
            <option value="BL">Belluno</option>
            <option value="BN">Benevento</option>
            <option value="BG">Bergamo</option>
            <option value="BI">Biella</option>
            <option value="BO">Bologna</option>
            <option value="BZ">Bolzano</option>
            <option value="BS">Brescia</option>
            <option value="BR">Brindisi</option>
            <option value="CA">Cagliari</option>
            <option value="CL">Caltanissetta</option>
            <option value="CB">Campobasso</option>
            <option value="CI">Carbonia-Iglesias</option>
            <option value="CE">Caserta</option>
            <option value="CT">Catania</option>
            <option value="CZ">Catanzaro</option>
            <option value="CH">Chieti</option>
            <option value="CO">Como</option>
            <option value="CS">Cosenza</option>
            <option value="CR">Cremona</option>
            <option value="KR">Crotone</option>
            <option value="CN">Cuneo</option>
            <option value="EN">Enna</option>
            <option value="FM">Fermo</option>
            <option value="FE">Ferrara</option>
            <option value="FI">Firenze</option>
            <option value="FG">Foggia</option>
            <option value="FC">Forlì-Cesena</option>
            <option value="FR">Frosinone</option>
            <option value="GE">Genova</option>
            <option value="GO">Gorizia</option>
            <option value="GR">Grosseto</option>
            <option value="IM">Imperia</option>
            <option value="IS">Isernia</option>
            <option value="SP">La Spezia</option>
            <option value="AQ">L'Aquila</option>
            <option value="LT">Latina</option>
            <option value="LE">Lecce</option>
            <option value="LC">Lecco</option>
            <option value="LI">Livorno</option>
            <option value="LO">Lodi</option>
            <option value="LU">Lucca</option>
            <option value="MC">Macerata</option>
            <option value="MN">Mantova</option>
            <option value="MS">Massa-Carrara</option>
            <option value="MT">Matera</option>
            <option value="VS">Medio Campidano</option>
            <option value="ME">Messina</option>
            <option value="MI">Milano</option>
            <option value="MO">Modena</option>
            <option value="MB">Monza e Brianza</option>
            <option value="NA">Napoli</option>
            <option value="NO">Novara</option>
            <option value="NU">Nuoro</option>
            <option value="OG">Ogliastra</option>
            <option value="OT">Olbia-Tempio</option>
            <option value="OR">Oristano</option>
            <option value="PD">Padova</option>
            <option value="PA">Palermo</option>
            <option value="PR">Parma</option>
            <option value="PV">Pavia</option>
            <option value="PG">Perugia</option>
            <option value="PU">Pesaro e urbino</option>
            <option value="PE">Pescara</option>
            <option value="PC">Piacenza</option>
            <option value="PI">Pisa</option>
            <option value="PT">Pistoia</option>
            <option value="PN">Pordenone</option>
            <option value="PZ">Potenza</option>
            <option value="PO">Prato</option>
            <option value="RG">Ragusa</option>
            <option value="RA">Ravenna</option>
            <option value="RC">Reggio Calabria</option>
            <option value="RE">Reggio Emilia</option>
            <option value="RI">Rieti</option>
            <option value="RN">Rimini</option>
            <option value="RM">Roma</option>
            <option value="RO">Rovigo</option>
            <option value="SA">Salerno</option>
            <option value="SS">Sassari</option>
            <option value="SV">Savona</option>
            <option value="SI">Siena</option>
            <option value="SR">Siracusa</option>
            <option value="SO">Sondrio</option>
            <option value="TA">Taranto</option>
            <option value="TE">Teramo</option>
            <option value="TR">Terni</option>
            <option value="TO">Torino</option>
            <option value="TP">Trapani</option>
            <option value="TN">Trento</option>
            <option value="TV">Treviso</option>
            <option value="TS">Trieste</option>
            <option value="UD">Udine</option>
            <option value="VA">Varese</option>
            <option value="VE">Venezia</option>
            <option value="VB">Verbano-Cusio-Ossola</option>
            <option value="VC">Vercelli</option>
            <option value="VR">Verona</option>
            <option value="VV">Vibo Valentia</option>
            <option value="VI">Vicenza</option>
            <option value="VT">Viterbo</option>
          </select>
          <div
            th:if="${#fields.hasErrors('energyClass')}"
            class="invalid-feedback"
          >
            <ul>
              <li
                th:each="err : ${#fields.errors('energyClass')}"
                th:text="${err}"
              ></li>
            </ul>
          </div>
        </div>

        <div class="form-floating mb-3 mt-3 has-validation">
          <input
            type="number"
            min="1"
            class="form-control"
            th:field="*{area}"
            id="area"
            th:errorClass="is-invalid"
            placeholder="Superficie calpestabile"
          />
          <label for="floatingInput">Superficie calpestabile</label>
          <div th:if="${#fields.hasErrors('area')}" class="invalid-feedback">
            <ul>
              <li
                th:each="err : ${#fields.errors('area')}"
                th:text="${err}"
              ></li>
            </ul>
          </div>
        </div>

        <div class="form-floating mb-3 mt-3 has-validation">
          <input
            type="number"
            min="1"
            class="form-control"
            th:field="*{price}"
            id="price"
            th:errorClass="is-invalid"
            placeholder="Prezzo"
          />
          <label for="floatingInput">Prezzo</label>
          <div th:if="${#fields.hasErrors('price')}" class="invalid-feedback">
            <ul>
              <li
                th:each="err : ${#fields.errors('price')}"
                th:text="${err}"
              ></li>
            </ul>
          </div>
        </div>

        <div class="form-floating mb-3 mt-3 has-validation">
          <input
            type="date"
            class="form-control"
            th:field="*{insertionDate}"
            id="insertionDate"
            th:errorClass="is-invalid"
            placeholder="Data inserimento annuncio"
          />
          <label for="floatingInput">Data inserimento annuncio</label>
          <div
            th:if="${#fields.hasErrors('insertionDate')}"
            class="invalid-feedback"
          >
            <ul>
              <li
                th:each="err : ${#fields.errors('insertionDate')}"
                th:text="${err}"
              ></li>
            </ul>
          </div>
        </div>

        <div class="form-floating mb-3 mt-3 has-validation">
          <input
            type="date"
            class="form-control"
            th:field="*{contractStart}"
            id="contractStart"
            th:errorClass="is-invalid"
            placeholder="Data inizio contratto"
          />
          <label for="floatingInput">Data inizio contratto</label>
          <div
            th:if="${#fields.hasErrors('contractStart')}"
            class="invalid-feedback"
          >
            <ul>
              <li
                th:each="err : ${#fields.errors('contractStart')}"
                th:text="${err}"
              ></li>
            </ul>
          </div>
        </div>

        <div class="form-floating mb-3 mt-3 has-validation">
          <span> <label for="status">Stato immobile</label> </span>
          <select
            name="status"
            id="status"
            th:field="*{status}"
            th:errorClass="is-invalid"
          >
            <option value="">--Scegli un'opzione--</option>
            <option value="In vendita">In vendita</option>
            <option value="In affitto">In affitto</option>
            <option value="Venduto">Venduto</option>
            <option value="Affittato">Affittato</option>
            <option value="Annullato">Annullato</option>
          </select>
          <div th:if="${#fields.hasErrors('status')}" class="invalid-feedback">
            <ul>
              <li
                th:each="err : ${#fields.errors('status')}"
                th:text="${err}"
              ></li>
            </ul>
          </div>
        </div>

        <div class="form-floating mb-3 mt-3 has-validation">
          <span> <label for="energyClass">Classe energetica</label> </span>

          <select
            name="energyClass"
            id="energyClass"
            th:field="*{energyClass}"
            th:errorClass="is-invalid"
          >
            <option value="">--Scegli un'opzione--</option>
            <option value="A4">A4</option>
            <option value="A3">A3</option>
            <option value="A2">A2</option>
            <option value="A1">A1</option>
            <option value="B">B</option>
            <option value="C">C</option>
            <option value="D">D</option>
            <option value="E">E</option>
            <option value="F">F</option>
            <option value="G">G</option>
          </select>
          <div
            th:if="${#fields.hasErrors('energyClass')}"
            class="invalid-feedback"
          >
            <ul>
              <li
                th:each="err : ${#fields.errors('energyClass')}"
                th:text="${err}"
              ></li>
            </ul>
          </div>
        </div>

        <div class="form-floating mb-3 mt-3 has-validation">
          <input
            type="text"
            class="form-control"
            th:field="*{type}"
            id="type"
            th:errorClass="is-invalid"
            placeholder="Tipo"
          />
          <label for="floatingInput">Tipo</label>
          <div th:if="${#fields.hasErrors('type')}" class="invalid-feedback">
            <ul>
              <li
                th:each="err : ${#fields.errors('type')}"
                th:text="${err}"
              ></li>
            </ul>
          </div>
        </div>

        <div class="form-floating mb-3 mt-3 has-validation">
          <input
            type="number"
            min="1"
            class="form-control"
            th:field="*{numSpaces}"
            id="numSpaces"
            th:errorClass="is-invalid"
            placeholder="Numero vani"
          />
          <label for="floatingInput">Numero vani</label>
          <div
            th:if="${#fields.hasErrors('numSpaces')}"
            class="invalid-feedback"
          >
            <ul>
              <li
                th:each="err : ${#fields.errors('numSpaces')}"
                th:text="${err}"
              ></li>
            </ul>
          </div>
        </div>

        <div class="form-floating mb-3 mt-3 has-validation">
          <input
            type="number"
            min="0"
            class="form-control"
            th:field="*{numBathrooms}"
            id="numBathrooms"
            th:errorClass="is-invalid"
            placeholder="Numero bagni"
          />
          <label for="floatingInput">Numero bagni</label>
          <div
            th:if="${#fields.hasErrors('numBathrooms')}"
            class="invalid-feedback"
          >
            <ul>
              <li
                th:each="err : ${#fields.errors('numBathrooms')}"
                th:text="${err}"
              ></li>
            </ul>
          </div>
        </div>

        <div class="form-floating mb-3 mt-3 has-validation">
          <input
            type="number"
            min="0"
            class="form-control"
            th:field="*{numBalconies}"
            id="numBalconies"
            th:errorClass="is-invalid"
            placeholder="Numero balconi"
          />
          <label for="floatingInput">Numero balconi</label>
          <div
            th:if="${#fields.hasErrors('numBalconies')}"
            class="invalid-feedback"
          >
            <ul>
              <li
                th:each="err : ${#fields.errors('numBalconies')}"
                th:text="${err}"
              ></li>
            </ul>
          </div>
        </div>

        <div class="form-floating mb-3 mt-3 has-validation">
          <input
            type="checkbox"
            id="hasCarSpot"
            name="hasCarSpot"
            th:field="*{hasCarSpot}"
            value="true"
          />
          <span>
            <label for="hasCarSpot">L'immobile ha il posto auto?</label>
          </span>
          <input type="reset" value="Reset" />
          <div
            th:if="${#fields.hasErrors('hasCarSpot')}"
            class="invalid-feedback"
          >
            <ul>
              <li
                th:each="err : ${#fields.errors('hasCarSpot)}"
                th:text="${err}"
              ></li>
            </ul>
          </div>
        </div>

        <div class="form-floating mb-3 mt-3 has-validation">
          <input
            type="checkbox"
            id="hasGarden"
            name="hasGarden"
            th:field="*{hasGarden}"
            value="true"
          />
          <span>
            <label for="hasGarden">L'immobile ha il giardino?</label>
          </span>
          <input type="reset" value="Reset" />
          <div
            th:if="${#fields.hasErrors('hasGarden')}"
            class="invalid-feedback"
          >
            <ul>
              <li
                th:each="err : ${#fields.errors('hasGarden')}"
                th:text="${err}"
              ></li>
            </ul>
          </div>
        </div>

        <div class="col-4">
          <h4>Agenti</h4>
          <div class="form-check" th:each="a : ${agentList}">
            <input
              class="form-check-input"
              th:field="*{agent}"
              type="checkbox"
              th:id="|agent_${a.id}|"
              th:value="${a.id}"
            />
            <label
              class="form-check-label"
              th:for="|agent_${a.id}|"
              th:text="|${a.surname} ${a.name}|"
            ></label>
          </div>
          <div th:if="${#fields.hasErrors('agent')}" class="invalid-feedback">
            <ul>
              <li
                th:each="err : ${#fields.errors('agent')}"
                th:text="${err}"
              ></li>
            </ul>
          </div>
        </div>

        

        <div>
          <button type="submit" class="btn btn-danger">Salva</button>
          <a class="btn btn-danger" href="/estate/admin/estateList">Annulla</a>
        </div>
      </form>
      
      <div class="mb-3 mt-3" th:if="${estate.id != null}">
          <form
            id="form-img"
            th:object="${imageForm}"
            th:action="|/estate/image/save/${estate.id}|"
            method="POST"
            enctype="multipart/form-data"
          >
            <input type="hidden" th:field="${estate.id}" />
            <div class="m-3">
              <label for="contentMultipart" class="form-label">Aggiungi una nuova immagine</label>
              <input class="form-control" type="file" id="contentMultipart" th:field="*{contentMultipart}">
            </div>
            <button class="btn btn-danger" type="submit">Salva</button>
          </form>
        </div>
    </div>
  </body>
</html>
